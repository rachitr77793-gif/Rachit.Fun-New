<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Clicker ‚Äî Rachit.Fun</title>
<style>
  :root{--bg:#f7fbff;--card:#fff;--muted:#64748b;--edge:#000}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#0f172a}
  /* topbar (same look as homepage) */
  .topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 18px;border-bottom:1px solid rgba(0,0,0,0.06);background:#fff;position:sticky;top:0;z-index:40}
  .brand-mini{display:flex;align-items:center;gap:8px;font-weight:700}
  .controls{display:flex;gap:10px;align-items:center}
  .btn{padding:.45rem .8rem;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:var(--card);cursor:pointer;font-weight:700}
  .color-input{width:34px;height:28px;border-radius:6px;border:1px solid #ccc}
  /* container */
  .container{max-width:900px;margin:20px auto;padding:18px;text-align:center}
  .title h1{font-size:2rem;margin:6px 0;font-weight:900}
  /* game panel */
  .game-panel{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.06);max-width:760px;margin:18px auto}
  .options{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:12px}
  .option-btn{padding:8px 12px;border-radius:10px;border:2px solid rgba(0,0,0,.06);background:white;cursor:pointer;font-weight:700}
  .start-btn{background:#6a5acd;color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:800}
  /* homepage-style medium-large rectangular click button */
  .click-btn{
    width:300px;
    height:80px;
    border-radius:14px;
    background:var(--card);
    border:4px solid var(--edge);
    font-size:1.2rem;
    font-weight:800;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    box-shadow:0 8px 18px rgba(0,0,0,0.08);
  }
  .stats{margin-top:16px;font-weight:700;color:var(--muted)}
  /* countdown overlay */
  .countdownOverlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.25);z-index:200}
  .countNum{font-size:6rem;color:white;font-weight:900;mix-blend-mode:screen;text-shadow:0 6px 18px rgba(0,0,0,0.6)}
  /* result modal */
  .overlay{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.35);display:none;align-items:center;justify-content:center;z-index:210}
  .modal{background:var(--card);padding:20px;border-radius:12px;min-width:280px;text-align:center;box-shadow:0 20px 50px rgba(0,0,0,0.2)}
  .modal h3{margin:6px 0 12px 0}
  .modal button{margin-top:12px;padding:8px 12px;border-radius:10px;border:none;background:#6a5acd;color:#fff;cursor:pointer}
  .score-row{margin:6px 0;font-weight:700}
  .small{font-size:0.95rem;color:var(--muted)}
  .scorePanel{position:fixed;right:18px;top:90px;background:var(--card);padding:12px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.08);display:none;min-width:220px;z-index:60}
  footer{max-width:1100px;margin:18px auto;text-align:center;color:var(--muted);font-size:.95rem;padding-bottom:28px}
  @media(max-width:520px){ .click-btn{width:88%;height:72px;font-size:1.1rem} }
</style>
</head>
<body>

<!-- TOPBAR: BG (left) then Home / Reset All (right) -->
<div class="topbar">
  <div class="brand-mini">üéÆ <span style="font-weight:800">Rachit.Fun</span></div>

  <!-- controls: BG left-of-rest per your instruction -->
  <div style="display:flex;align-items:center;gap:12px">
    <label style="display:flex;align-items:center;gap:6px;font-weight:700">BG <input id="bgColor" class="color-input" type="color" value="#f7fbff"></label>
    <div class="controls">
      <button id="homeBtn" class="btn">Home</button>
      <button id="resetBtn" class="btn">Reset All</button>
    </div>
  </div>
</div>

<main class="container">
  <div class="title"><h1>üñ±Ô∏è Clicker</h1></div>

  <div class="game-panel" role="region" aria-label="Clicker game">
    <div class="small">Choose time (1 / 5 / 10 / 15), press Start, a 3‚Äì2‚Äì1 countdown will run, then click the button as fast as you can.</div>

    <div class="options" style="margin-top:12px;">
      <button class="option-btn" data-sec="1">1s</button>
      <button class="option-btn" data-sec="5">5s</button>
      <button class="option-btn" data-sec="10">10s</button>
      <button class="option-btn" data-sec="15">15s</button>
      <button id="startBtn" class="start-btn">Start</button>
    </div>

    <div style="margin-top:14px;">
      <button id="clickBtn" class="click-btn" aria-disabled="true" title="Click when game is running">Click Me!</button>
    </div>

    <div class="stats" style="margin-top:12px;">
      Time left: <span id="timeLeft">‚Äî</span> &nbsp;‚Ä¢&nbsp;
      Clicks: <span id="clickCount">0</span> &nbsp;‚Ä¢&nbsp;
      CPS: <span id="cps">0.0</span> &nbsp;‚Ä¢&nbsp;
      CPM: <span id="cpm">0</span>
    </div>
  </div>
</main>

<!-- countdown overlay (3,2,1) -->
<div id="countdown" class="countdownOverlay"><div class="countNum" id="countNum">3</div></div>

<!-- result overlay -->
<div id="overlay" class="overlay" role="dialog" aria-modal="true">
  <div class="modal">
    <h3>Time's up!</h3>
    <div class="score-row">Clicks: <span id="resClicks">0</span></div>
    <div class="score-row">CPS: <span id="resCPS">0.0</span></div>
    <div class="score-row">CPM (WPM style): <span id="resCPM">0</span></div>
    <div class="small">Best: <span id="bestText">‚Äî</span></div>
    <button id="closeOverlay">OK</button>
  </div>
</div>

<!-- scores panel (only used to show best when user opens it from homepage) -->
<aside id="scorePanel" class="scorePanel" aria-hidden="true">
  <strong>Local best scores</strong>
  <div id="scoresList" style="margin-top:8px"></div>
  <div style="text-align:right;margin-top:8px"><button id="closeScores" class="btn">Close</button></div>
</aside>

<footer><div style="max-width:1100px;margin:18px auto;text-align:center;color:var(--muted)">Rachit.Fun ‚Äî made by Rachit Raikwar</div></footer>

<script>
/* Behavior:
   - No music or scores control on page (homepage handles music/scores).
   - BG color persists.
   - Start => 3s countdown overlay => timed run.
   - End => show overlay with stats and save best (localStorage rachit_scores.clicker).
   - Reset All sets 'rachit_stop_all' so homepage and games can listen.
*/

// keys
const STOP_KEY = 'rachit_stop_all';
const SCORE_KEY = 'rachit_scores';

// UI refs
const bgColor = document.getElementById('bgColor');
const homeBtn = document.getElementById('homeBtn');
const resetBtn = document.getElementById('resetBtn');

const optionBtns = Array.from(document.querySelectorAll('.option-btn'));
const startBtn = document.getElementById('startBtn');
const clickBtn = document.getElementById('clickBtn');
const timeLeftEl = document.getElementById('timeLeft');
const clickCountEl = document.getElementById('clickCount');
const cpsEl = document.getElementById('cps');
const cpmEl = document.getElementById('cpm');

const countdown = document.getElementById('countdown');
const countNum = document.getElementById('countNum');

const overlay = document.getElementById('overlay');
const resClicks = document.getElementById('resClicks');
const resCPS = document.getElementById('resCPS');
const resCPM = document.getElementById('resCPM');
const closeOverlay = document.getElementById('closeOverlay');
const bestText = document.getElementById('bestText');

const scorePanel = document.getElementById('scorePanel');
const scoresList = document.getElementById('scoresList');
const closeScores = document.getElementById('closeScores');

// persist bg color
const savedBg = localStorage.getItem('rachit_bg');
if(savedBg){ document.body.style.background = savedBg; bgColor.value = savedBg; }
bgColor.addEventListener('input', e=>{ document.body.style.background = e.target.value; localStorage.setItem('rachit_bg', e.target.value); });

// Home / Reset All handlers
homeBtn.addEventListener('click', ()=> window.location.href = 'HomePagefinal.html');
resetBtn.addEventListener('click', ()=>{
  if(confirm('Reset everything? This clears local scores and settings.')){
    localStorage.setItem(STOP_KEY, Date.now());
    localStorage.removeItem(SCORE_KEY);
    localStorage.removeItem('rachit_bg');
    localStorage.removeItem('rachit_music');
    location.href = 'HomePagefinal.html';
  }
});

// stop signal listener
window.addEventListener('storage', e=>{
  if(e.key === STOP_KEY){
    stopGameImmediate();
  }
});

// option select
let chosenSeconds = null;
optionBtns.forEach(b=>{
  b.addEventListener('click', ()=>{
    optionBtns.forEach(x=> x.style.outline = 'none');
    b.style.outline = '3px solid rgba(0,0,0,0.08)';
    chosenSeconds = parseInt(b.dataset.sec,10);
  });
});

// start: show 3-2-1 then begin
let running = false;
let clicks = 0;
let intervalId = null;

startBtn.addEventListener('click', async ()=>{
  if(!chosenSeconds){ alert('Choose a timer (1 / 5 / 10 / 15 seconds)'); return; }
  // 3-2-1 countdown
  await runCountdown();
  beginRun(chosenSeconds);
});

async function runCountdown(){
  countdown.style.display = 'flex';
  for(let i=3;i>=1;i--){
    countNum.textContent = i;
    await new Promise(r=> setTimeout(r, 700)); // 700ms per number (fast, total ~2.1s)
  }
  countdown.style.display = 'none';
}

// begin timed run
function beginRun(seconds){
  running = true;
  clicks = 0;
  clickCountEl.textContent = '0';
  timeLeftEl.textContent = seconds.toFixed(2);
  cpsEl.textContent = '0.0';
  cpmEl.textContent = '0';
  clickBtn.setAttribute('aria-disabled','false');

  const startTime = Date.now();
  intervalId = setInterval(()=>{
    const elapsed = (Date.now() - startTime)/1000;
    const left = Math.max(0, seconds - elapsed);
    timeLeftEl.textContent = left.toFixed(2);
    if(left <= 0) endGame(seconds);
  }, 80);
}

// clicking
clickBtn.addEventListener('click', ()=>{
  if(!running) return;
  clicks++;
  clickCountEl.textContent = clicks;
  updateRates();
});
clickBtn.addEventListener('touchstart', e=>{ if(running){ clicks++; clickCountEl.textContent=clicks; updateRates(); }}, {passive:true});

function updateRates(){
  const elapsed = (chosenSeconds || 1) - parseFloat(timeLeftEl.textContent || '0');
  const secsSoFar = Math.max(elapsed, 0.0001);
  const cps = clicks / secsSoFar;
  const cpm = Math.round(cps * 60);
  cpsEl.textContent = cps.toFixed(1);
  cpmEl.textContent = cpm;
}

function endGame(seconds){
  if(!running) return;
  running = false;
  clearInterval(intervalId);
  clickBtn.setAttribute('aria-disabled','true');

  const cps = clicks / seconds;
  const cpm = Math.round(cps * 60);

  // present results
  resClicks.textContent = clicks;
  resCPS.textContent = cps.toFixed(2);
  resCPM.textContent = cpm;

  // save best by CPM
  try{
    const s = JSON.parse(localStorage.getItem(SCORE_KEY) || '{}');
    const prev = s.clicker || null;
    if(!prev || cpm > (prev.cpm||0)){
      s.clicker = { clicks, cps: Number(cps.toFixed(2)), cpm };
      localStorage.setItem(SCORE_KEY, JSON.stringify(s));
    }
    bestText.textContent = s.clicker ? `${s.clicker.clicks} clicks ‚Ä¢ ${s.clicker.cpm} CPM` : '‚Äî';
  }catch(e){ bestText.textContent = '‚Äî'; }

  overlay.style.display = 'flex';
  timeLeftEl.textContent = '0.00';
  clickCountEl.textContent = clicks;
  cpsEl.textContent = cps.toFixed(1);
  cpmEl.textContent = cpm;
}

// overlay close
closeOverlay.addEventListener('click', ()=> overlay.style.display = 'none');

// immediate stop (Reset All)
function stopGameImmediate(){
  if(intervalId) clearInterval(intervalId);
  running = false;
  clicks = 0;
  clickCountEl.textContent = '0';
  timeLeftEl.textContent = '‚Äî';
  cpsEl.textContent = '0.0';
  cpmEl.textContent = '0';
  overlay.style.display = 'none';
}

// scores panel functions (kept but not shown on page ‚Äî homepage shows scores)
function renderScoresPanel(){
  const s = JSON.parse(localStorage.getItem(SCORE_KEY) || '{}');
  scoresList.innerHTML = '';
  const r = document.createElement('div');
  r.textContent = s.clicker ? `Clicker: ${s.clicker.clicks} clicks ‚Ä¢ ${s.clicker.cpm} CPM` : 'Clicker: ‚Äî';
  scoresList.appendChild(r);
}
closeScores.addEventListener('click', ()=> scorePanel.style.display='none');

// keyboard helper
window.addEventListener('keydown', e=>{
  if(e.key === '1') optionBtns[0].click();
  if(e.key === '5') optionBtns[1].click();
  if(e.key === '0') optionBtns[2].click();
  if(e.key === '9') optionBtns[3].click();
});
  <script src="redirect.js"></script>

</script>
</body>
</html>

