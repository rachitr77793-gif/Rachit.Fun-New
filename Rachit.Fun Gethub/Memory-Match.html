<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rachit.Fun â€” Memory Match</title>
<style>
  :root{--card:#fff;--muted:#64748b}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:#f7fbff;color:#071133}

  /* Ribbon / Taskbar (exact style you provided) */
  .topbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 20px;
    background:transparent;
    border-bottom:1px solid rgba(0,0,0,0.03);
    position:sticky;
    top:0;
    z-index:50;
  }
  .left{display:flex;align-items:center;gap:12px;font-weight:800}
  .left .logo{font-size:20px}
  .left .site{font-size:20px}
  .right{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .color-picker{width:36px;height:28px;border-radius:8px;border:1px solid #ccc;padding:0}
  .score-pill{padding:6px 10px;border-radius:999px;background:linear-gradient(180deg,#fff,#f1f5f9);border:1px solid rgba(0,0,0,0.06);font-weight:700}
  .btn{background:var(--card);border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:700}

  /* Page layout */
  .page-title{text-align:center;margin:20px 0}
  .page-title h1{font-size:32px;margin:6px 0}
  .grid-wrap{max-width:980px;margin:0 auto;padding:20px;display:flex;flex-direction:column;gap:20px}
  .controls-row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:10px}

  /* Grid */
  .grid{display:grid;gap:10px;border-radius:12px;overflow:hidden;justify-content:center}
  .cell{
    width:70px; height:70px;
    display:flex;align-items:center;justify-content:center;
    font-size:32px; background:#eee; border-radius:10px;
    cursor:pointer; user-select:none; transition:0.3s;
  }
  .cell.flipped, .cell.matched{background:#fff;}

  /* Stats area (below grid) */
  .stats-row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:12px}
  .stat{padding:8px 12px;border-radius:10px;background:linear-gradient(180deg,#fff,#f7fafc);border:1px solid rgba(0,0,0,0.05);font-weight:800}

  footer{text-align:center;color:var(--muted);margin:30px auto;padding-bottom:30px}
  .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.35);z-index:90}
  .panel{background:white;padding:18px;border-radius:12px;min-width:260px;text-align:center}
  .countdown{font-size:48px;font-weight:900}

  /* responsive */
  @media (max-width:700px){ .cell{width:50px;height:50px;font-size:22px} }
</style>
</head>
<body>

<header class="topbar">
  <div class="left">
    <div class="logo">ðŸŽ®</div>
    <div class="site">Rachit.Fun</div>
  </div>

  <div class="right">
    <label style="display:flex;align-items:center;gap:8px;font-weight:700">
      BG
      <input id="bgPicker" class="color-picker" type="color" value="#f7fbff" />
    </label>
    <button class="btn" id="homeBtn">Home</button>
    <button class="btn" id="resetAllBtn">Reset All</button>
  </div>
</header>

<div class="page-title">
  <h1>ðŸ§  Memory Match</h1>
  <p>Match all pairs â€” the grid is visible below. Choose difficulty and press Start Game.</p>
</div>

<section class="grid-wrap">
  <div class="controls-row">
    <button class="btn" id="startBtn">Start Game</button>

    <div id="difficultyBox" style="display:flex;align-items:center;gap:8px">
      <label style="font-weight:700">Difficulty</label>
      <select id="diffSelect" class="btn" style="padding:6px;border-radius:8px">
        <option value="3">Easy â€” 3Ã—3</option>
        <option value="6" selected>Normal â€” 6Ã—6</option>
        <option value="8">Hard â€” 8Ã—8</option>
      </select>
    </div>
  </div>

  <div id="grid" class="grid"></div>

  <div class="stats-row" id="statsRow" style="display:none">
    <div class="stat">Time: <span id="timer">0</span>s</div>
    <div class="stat">Moves: <span id="movesNum">0</span></div>
    <div class="stat">Pairs: <span id="pairsNum">0</span></div>
  </div>

  <div class="stats-row" style="margin-top:6px">
    <div class="stat">Best Time: <span id="bestTime">--</span></div>
    <div class="stat">Best Moves: <span id="bestMoves">--</span></div>
    <div class="stat"><button class="btn" id="saveScore">Save Score</button></div>
    <div class="stat"><button class="btn" id="clearScore">Clear</button></div>
  </div>
</section>

<footer>Rachit.Fun â€” made by Rachit Raikwar</footer>

<div id="overlay" class="overlay" style="display:none">
  <div class="panel">
    <div id="overlayText" style="font-weight:800;margin-bottom:12px"></div>
    <div id="countdown" class="countdown"></div>
    <div style="margin-top:10px"><button class="btn" id="overlayOk">OK</button></div>
  </div>
</div>

<script>
/* Persistent BG */
const BG_KEY = 'rachit_bg';
const bgPicker = document.getElementById('bgPicker');
const saved = localStorage.getItem(BG_KEY);
if (saved) { document.body.style.background = saved; bgPicker.value = saved; }
bgPicker.addEventListener('input', e => { document.body.style.background = e.target.value; localStorage.setItem(BG_KEY, e.target.value); });

/* DOM */
const gridEl = document.getElementById('grid');
const startBtn = document.getElementById('startBtn');
const diffSelect = document.getElementById('diffSelect');
const statsRow = document.getElementById('statsRow');
const timerEl = document.getElementById('timer');
const movesEl = document.getElementById('movesNum');
const pairsEl = document.getElementById('pairsNum');
const bestTimeEl = document.getElementById('bestTime');
const bestMovesEl = document.getElementById('bestMoves');
const saveScoreBtn = document.getElementById('saveScore');
const clearScoreBtn = document.getElementById('clearScore');

let ROWS = 6, COLS = 6;
let deck = [];
let first = null, second = null;
let lock = false;
let matchedPairs = 0;
let moves = 0;
let seconds = 0;
let timer = null;
let running = false;

const EMOJIS = ['ðŸŽ','ðŸŒ','ðŸ‡','ðŸ‰','ðŸ’','ðŸ‘','ðŸ¥','ðŸ¥‘','ðŸ','ðŸ¥¥','ðŸ“','ðŸ‹','ðŸ¥•','ðŸŒ½','ðŸ¥”','ðŸ†','ðŸ…','ðŸ¥­','ðŸ¥¬','ðŸ„','â­','ðŸ”¥','ðŸŒˆ','ðŸ€','ðŸ’§','ðŸŽˆ','ðŸ±','ðŸ¶','ðŸ˜Ž','ðŸ˜€','ðŸ¤–','ðŸ‘»','ðŸŽƒ','ðŸ¦Š','ðŸ¼','ðŸ¦„','ðŸ©','ðŸª','ðŸ°'];

function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

function buildDeck(){ const total = ROWS * COLS; const pairsNeeded = Math.floor(total/2);
  const chosen = shuffle(EMOJIS.slice()).slice(0,pairsNeeded);
  deck = shuffle([...chosen,...chosen]); }

function drawGrid(){ gridEl.innerHTML=''; gridEl.style.gridTemplateColumns = `repeat(${COLS},70px)`; gridEl.style.gridTemplateRows = `repeat(${ROWS},70px)`;
  deck.forEach((icon,i)=>{
    const div = document.createElement('div');
    div.className='cell';
    div.dataset.icon = icon;
    div.dataset.index = i;
    div.addEventListener('click', tileClick);
    gridEl.appendChild(div);
  }); }

function tileClick(e){ if(!running) return; const div = e.currentTarget; if(div.classList.contains('flipped')||div.classList.contains('matched')||lock) return; flip(div);
  moves++; movesEl.textContent = moves;
  if(!first){ first = div; return; }
  second = div; checkMatch(); }

function flip(div){ div.classList.add('flipped'); div.textContent = div.dataset.icon; }
function unflip(div){ div.classList.remove('flipped'); div.textContent=''; }

function checkMatch(){ lock=true; if(first.dataset.icon === second.dataset.icon){ first.classList.add('matched'); second.classList.add('matched'); matchedPairs++; pairsEl.textContent = matchedPairs; lock=false; first=null; second=null; if(matchedPairs === Math.floor((ROWS*COLS)/2)) levelComplete(); } else { setTimeout(()=>{ unflip(first); unflip(second); first=null; second=null; lock=false; },800); } }

function startTimer(){ clearInterval(timer); seconds=0; timerEl.textContent=seconds; timer=setInterval(()=>{ seconds++; timerEl.textContent=seconds; },1000); }
function stopTimer(){ clearInterval(timer); }

function startCountdown(cb){ document.getElementById('overlay').style.display='flex'; overlayText.textContent='Get Ready'; let n=3; document.getElementById('countdown').textContent=n; const t=setInterval(()=>{ n--; if(n<=0){ clearInterval(t); document.getElementById('overlay').style.display='none'; cb(); } else document.getElementById('countdown').textContent=n; },1000); }

startBtn.addEventListener('click', ()=>{
  ROWS = parseInt(diffSelect.value); COLS = ROWS;
  buildDeck(); drawGrid(); matchedPairs=0; moves=0; seconds=0; movesEl.textContent=0; pairsEl.textContent=0; timerEl.textContent=0; statsRow.style.display='flex'; running=false;
  startCountdown(()=>{ running=true; startTimer(); });
});

function levelComplete(){ stopTimer(); running=false; 
  const keyTime = 'rachit_memory_best_time_' + (ROWS+'x'+COLS);
  const keyMoves = 'rachit_memory_best_moves_' + (ROWS+'x'+COLS);
  const prevTime = parseInt(localStorage.getItem(keyTime) || '0',10);
  const prevMoves = parseInt(localStorage.getItem(keyMoves) || '0',10);
  if(prevTime===0 || seconds < prevTime) localStorage.setItem(keyTime, seconds);
  if(prevMoves===0 || moves < prevMoves) localStorage.setItem(keyMoves, moves);
  updateBests(); alert(`You won! Moves: ${moves} | Time: ${seconds}s`);
}

function updateBests(){ const keyTime = 'rachit_memory_best_time_' + (ROWS+'x'+COLS); const keyMoves = 'rachit_memory_best_moves_' + (ROWS+'x'+COLS); const bt = localStorage.getItem(keyTime); const bm = localStorage.getItem(keyMoves); bestTimeEl.textContent = bt ? bt + 's' : '--'; bestMovesEl.textContent = bm ? bm : '--'; }
updateBests();

saveScoreBtn.addEventListener('click', ()=>{ const payload = { grid: ROWS+'x'+COLS, time: seconds, moves: moves }; localStorage.setItem('rachit_memory_last', JSON.stringify(payload)); alert('Score saved locally'); });
clearScoreBtn.addEventListener('click', ()=>{ if(confirm('Clear bests for all sizes?')){ Object.keys(localStorage).forEach(k=>{ if(k.startsWith('rachit_memory_best_')||k==='rachit_memory_last') localStorage.removeItem(k); }); updateBests(); alert('Cleared'); } });

/* FIXED HOME BUTTON â†“â†“â†“ */
document.getElementById('homeBtn').addEventListener('click', ()=>{
  window.location.href='HomePagefinal.html';
});
/* END FIX */

/* Reset all */
document.getElementById('resetAllBtn').addEventListener('click', ()=>{ 
  if(confirm('Reset everything?')){
    localStorage.removeItem(BG_KEY);
    location.reload(); 
  }
});

document.getElementById('overlayOk').addEventListener('click', ()=>{ 
  document.getElementById('overlay').style.display='none'; 
});

/* Init preview grid */
buildDeck(); drawGrid();
</script>
</body>
</html>
